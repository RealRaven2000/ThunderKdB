<?xml version="1.0"?>
<?xml-stylesheet href="chrome://global/skin/global.css" type="text/css"?>
<?xml-stylesheet href="chrome://mailmerge/content/dialog.css" type="text/css"?>

<dialog
	id="mailmerge"
	windowtype="mailmerge"
	xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
	xmlns:html="http://www.w3.org/1999/xhtml"
	title="Mail Merge"
	buttons="accept,cancel,help"
	onload="mailmerge.load();">
	
	<script type="application/x-javascript" src="chrome://mailmerge/content/dialog.js" />
	
	<vbox id="mailmerge-content">
		
		<html:fieldset id="mailmerge-general">
			<html:legend i18n="mailmerge.dialog.general"></html:legend>
			<html:div>
				<html:span id="mailmerge-general-source-label" i18n="mailmerge.dialog.general.source"></html:span>
				<html:span />
				<html:span><html:select id="mailmerge-general-source" aria-labelledby="mailmerge-general-source-label" onchange="mailmerge.select();" /></html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-general-delivermode-label" i18n="mailmerge.dialog.general.delivermode"></html:span>
				<html:span />
				<html:span><html:select id="mailmerge-general-delivermode" aria-labelledby="mailmerge-general-delivermode-label" onchange="mailmerge.select();" /></html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-general-attachments-label" i18n="mailmerge.dialog.general.attachments"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-general-attachments-checkbox" aria-labelledby="mailmerge-general-attachments-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:textarea id="mailmerge-general-attachments" aria-labelledby="mailmerge-general-attachments-label" rows="3" /></html:span>
			</html:div>
		</html:fieldset>
		
		<html:fieldset id="mailmerge-cardbook">
			<html:legend i18n="mailmerge.dialog.cardbook"></html:legend>
			<html:div>
				<html:span id="mailmerge-cardbook-addressbook-label" i18n="mailmerge.dialog.cardbook.addressbook"></html:span>
				<html:span />
				<html:span><html:select id="mailmerge-cardbook-addressbook" aria-labelledby="mailmerge-cardbook-addressbook-label" /></html:span>
			</html:div>
		</html:fieldset>
		
		<html:fieldset id="mailmerge-addressbook">
			<html:legend i18n="mailmerge.dialog.addressbook"></html:legend>
			<html:div>
				<html:span id="mailmerge-addressbook-addressbook-label" i18n="mailmerge.dialog.addressbook.addressbook"></html:span>
				<html:span />
				<html:span><html:select id="mailmerge-addressbook-addressbook" aria-labelledby="mailmerge-addressbook-addressbook-label" /></html:span>
			</html:div>
		</html:fieldset>
		
		<html:fieldset id="mailmerge-csv">
			<html:legend i18n="mailmerge.dialog.csv"></html:legend>
			<html:div>
				<html:span id="mailmerge-csv-file-label" i18n="mailmerge.dialog.csv.file"></html:span>
				<html:span />
				<html:span>
					<html:input type="text" id="mailmerge-csv-file" aria-labelledby="mailmerge-csv-file-label" />
					<html:br />
					<html:input type="button" i18n="value=mailmerge.dialog.csv.browse" onclick="mailmerge.browse('CSV');" />
					<html:input type="button" i18n="value=mailmerge.dialog.csv.preview" onclick="mailmerge.preview('CSV');" />
				</html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-csv-characterset-label" i18n="mailmerge.dialog.csv.characterset"></html:span>
				<html:span />
				<html:span>
					<html:input type="text" id="mailmerge-csv-characterset" aria-labelledby="mailmerge-csv-characterset-label" onchange="document.getElementById('mailmerge-csv-characterset').value = document.getElementById('mailmerge-csv-characterset-select').value = this.value;" />
					<html:select id="mailmerge-csv-characterset-select" aria-labelledby="mailmerge-csv-characterset-label" onchange="document.getElementById('mailmerge-csv-characterset').value = document.getElementById('mailmerge-csv-characterset-select').value = this.value;" />
				</html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-csv-fielddelimiter-label" i18n="mailmerge.dialog.csv.fielddelimiter"></html:span>
				<html:span />
				<html:span><html:select id="mailmerge-csv-fielddelimiter" aria-labelledby="mailmerge-csv-fielddelimiter-label" /></html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-csv-textdelimiter-label" i18n="mailmerge.dialog.csv.textdelimiter"></html:span>
				<html:span />
				<html:span><html:select id="mailmerge-csv-textdelimiter" aria-labelledby="mailmerge-csv-textdelimiter-label" /></html:span>
			</html:div>
		</html:fieldset>
		
		<html:fieldset id="mailmerge-json">
			<html:legend i18n="mailmerge.dialog.json"></html:legend>
			<html:div>
				<html:span id="mailmerge-json-file-label" i18n="mailmerge.dialog.json.file"></html:span>
				<html:span />
				<html:span>
					<html:input type="text" id="mailmerge-json-file" aria-labelledby="mailmerge-json-file-label" />
					<html:br />
					<html:input type="button" i18n="value=mailmerge.dialog.json.browse" onclick="mailmerge.browse('JSON');" />
					<html:input type="button" i18n="value=mailmerge.dialog.json.preview" onclick="mailmerge.preview('JSON');" />
				</html:span>
			</html:div>
		</html:fieldset>
		
		<html:fieldset id="mailmerge-xlsx">
			<html:legend i18n="mailmerge.dialog.xlsx"></html:legend>
			<html:div>
				<html:span id="mailmerge-xlsx-file-label" i18n="mailmerge.dialog.xlsx.file"></html:span>
				<html:span />
				<html:span>
					<html:input type="text" id="mailmerge-xlsx-file" aria-labelledby="mailmerge-xlsx-file-label" />
					<html:br />
					<html:input type="button" i18n="value=mailmerge.dialog.xlsx.browse" onclick="mailmerge.browse('XLSX');" />
					<html:input type="button" i18n="value=mailmerge.dialog.xlsx.preview" onclick="mailmerge.preview('XLSX');" />
				</html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-xlsx-sheetname-label" i18n="mailmerge.dialog.xlsx.sheetname"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-xlsx-sheetname-checkbox" aria-labelledby="mailmerge-xlsx-sheetname-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:input type="text" id="mailmerge-xlsx-sheetname" aria-labelledby="mailmerge-xlsx-sheetname-label" /></html:span>
			</html:div>
		</html:fieldset>
		
		<html:fieldset id="mailmerge-batch">
			<html:legend i18n="mailmerge.dialog.batch"></html:legend>
			<html:div>
				<html:span id="mailmerge-batch-start-label" i18n="mailmerge.dialog.batch.start"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-batch-start-checkbox" aria-labelledby="mailmerge-batch-start-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:input type="number" id="mailmerge-batch-start" aria-labelledby="mailmerge-batch-start-label" min="1" /></html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-batch-stop-label" i18n="mailmerge.dialog.batch.stop"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-batch-stop-checkbox" aria-labelledby="mailmerge-batch-stop-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:input type="number" id="mailmerge-batch-stop" aria-labelledby="mailmerge-batch-stop-label" min="1" /></html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-batch-pause-label" i18n="mailmerge.dialog.batch.pause"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-batch-pause-checkbox" aria-labelledby="mailmerge-batch-pause-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:input type="text" id="mailmerge-batch-pause" aria-labelledby="mailmerge-batch-pause-label" /></html:span>
			</html:div>
		</html:fieldset>
		
		<html:fieldset id="mailmerge-sendlater">
			<html:legend i18n="mailmerge.dialog.sendlater"></html:legend>
			<html:div>
				<html:span id="mailmerge-sendlater-at-label" i18n="mailmerge.dialog.sendlater.at"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-sendlater-at-checkbox" aria-labelledby="mailmerge-sendlater-at-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:input type="text" id="mailmerge-sendlater-at" aria-labelledby="mailmerge-sendlater-at-label" placeholder="YYYY-MM-DD HH:MM" /></html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-sendlater-recur-label" i18n="mailmerge.dialog.sendlater.recur"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-sendlater-recur-checkbox" aria-labelledby="mailmerge-sendlater-recur-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:select id="mailmerge-sendlater-recur" aria-labelledby="mailmerge-sendlater-recur-label" /></html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-sendlater-every-label" i18n="mailmerge.dialog.sendlater.every"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-sendlater-every-checkbox" aria-labelledby="mailmerge-sendlater-every-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:input type="number" id="mailmerge-sendlater-every" aria-labelledby="mailmerge-sendlater-every-label" min="1" /></html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-sendlater-between-label" i18n="mailmerge.dialog.sendlater.between"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-sendlater-between-checkbox" aria-labelledby="mailmerge-sendlater-between-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:input type="text" id="mailmerge-sendlater-between" aria-labelledby="mailmerge-sendlater-between-label" placeholder="HH:MM HH:MM" /></html:span>
			</html:div>
			<html:div>
				<html:span id="mailmerge-sendlater-only-label" i18n="mailmerge.dialog.sendlater.only"></html:span>
				<html:span><html:input type="checkbox" id="mailmerge-sendlater-only-checkbox" aria-labelledby="mailmerge-sendlater-only-label" onchange="mailmerge.checkbox();" /></html:span>
				<html:span><html:select id="mailmerge-sendlater-only" aria-labelledby="mailmerge-sendlater-only-label" multiple="true" size="7" /></html:span>
			</html:div>
		</html:fieldset>
		
	</vbox>
	
	<hbox>
		
		<button dlgtype="help" />
		<spacer flex="1" />
		<button i18n="label=mailmerge.dialog.reset" oncommand="mailmerge.reset();" />
		<button i18n="label=mailmerge.dialog.preview" oncommand="mailmerge.preview('MESSAGE');" />
		<spacer flex="1" />
		<button dlgtype="cancel" />
		<button dlgtype="accept" />
		
	</hbox>
	
</dialog>
