!function(t){var e={};function s(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=e,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(r,a,function(e){return t[e]}.bind(null,a));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=160)}({11:function(t,e,s){var r,a,i;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,a=[t],void 0===(i="function"==typeof(r=function(t){"use strict";if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const e="The message port closed before a response was received.",s="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",r=t=>{const r={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(r).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class a extends WeakMap{constructor(t,e){super(e),this.createItem=t}get(t){return this.has(t)||this.set(t,this.createItem(t)),super.get(t)}}const i=(e,s)=>(...r)=>{t.runtime.lastError?e.reject(t.runtime.lastError):s.singleCallbackArg||r.length<=1&&!1!==s.singleCallbackArg?e.resolve(r[0]):e.resolve(r)},n=t=>1==t?"argument":"arguments",o=(t,e,s)=>new Proxy(e,{apply:(e,r,a)=>s.call(r,t,...a)});let g=Function.call.bind(Object.prototype.hasOwnProperty);const l=(t,e={},s={})=>{let r=Object.create(null),a={has:(e,s)=>s in t||s in r,get(a,c,h){if(c in r)return r[c];if(!(c in t))return;let u=t[c];if("function"==typeof u)if("function"==typeof e[c])u=o(t,t[c],e[c]);else if(g(s,c)){let e=((t,e)=>function(s,...r){if(r.length<e.minArgs)throw new Error(`Expected at least ${e.minArgs} ${n(e.minArgs)} for ${t}(), got ${r.length}`);if(r.length>e.maxArgs)throw new Error(`Expected at most ${e.maxArgs} ${n(e.maxArgs)} for ${t}(), got ${r.length}`);return new Promise((a,n)=>{if(e.fallbackToNoCallback)try{s[t](...r,i({resolve:a,reject:n},e))}catch(i){console.warn(t+" API method doesn't seem to support the callback parameter, falling back to call it without a callback: ",i),s[t](...r),e.fallbackToNoCallback=!1,e.noCallback=!0,a()}else e.noCallback?(s[t](...r),a()):s[t](...r,i({resolve:a,reject:n},e))})})(c,s[c]);u=o(t,t[c],e)}else u=u.bind(t);else if("object"==typeof u&&null!==u&&(g(e,c)||g(s,c)))u=l(u,e[c],s[c]);else{if(!g(s,"*"))return Object.defineProperty(r,c,{configurable:!0,enumerable:!0,get:()=>t[c],set(e){t[c]=e}}),u;u=l(u,e[c],s["*"])}return r[c]=u,u},set:(e,s,a,i)=>(s in r?r[s]=a:t[s]=a,!0),defineProperty:(t,e,s)=>Reflect.defineProperty(r,e,s),deleteProperty:(t,e)=>Reflect.deleteProperty(r,e)},c=Object.create(t);return new Proxy(c,a)},c=t=>({addListener(e,s,...r){e.addListener(t.get(s),...r)},hasListener:(e,s)=>e.hasListener(t.get(s)),removeListener(e,s){e.removeListener(t.get(s))}});let h=!1;const u=new a(t=>"function"!=typeof t?t:function(e,r,a){let i,n,o=!1,g=new Promise(t=>{i=function(e){h||(console.warn(s,(new Error).stack),h=!0),o=!0,t(e)}});try{n=t(e,r,i)}catch(t){n=Promise.reject(t)}const l=!0!==n&&(c=n)&&"object"==typeof c&&"function"==typeof c.then;var c;if(!0!==n&&!l&&!o)return!1;const u=t=>{t.then(t=>{a(t)},t=>{let e;e=t&&(t instanceof Error||"string"==typeof t.message)?t.message:"An unexpected error occurred",a({__mozWebExtensionPolyfillReject__:!0,message:e})}).catch(t=>{console.error("Failed to send onMessage rejected reply",t)})};return u(l?n:g),!0}),m=({reject:s,resolve:r},a)=>{t.runtime.lastError?t.runtime.lastError.message===e?r():s(t.runtime.lastError):a&&a.__mozWebExtensionPolyfillReject__?s(new Error(a.message)):r(a)},f=(t,e,s,...r)=>{if(r.length<e.minArgs)throw new Error(`Expected at least ${e.minArgs} ${n(e.minArgs)} for ${t}(), got ${r.length}`);if(r.length>e.maxArgs)throw new Error(`Expected at most ${e.maxArgs} ${n(e.maxArgs)} for ${t}(), got ${r.length}`);return new Promise((t,e)=>{const a=m.bind(null,{resolve:t,reject:e});r.push(a),s.sendMessage(...r)})},d={runtime:{onMessage:c(u),onMessageExternal:c(u),sendMessage:f.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:f.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},A={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return r.privacy={network:{"*":A},services:{"*":A},websites:{"*":A}},l(t,d,r)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");t.exports=r(chrome)}else t.exports=browser})?r.apply(e,a):r)||(t.exports=i)},12:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));class r{constructor(t,e,s,r){this.id_=t,this.key_=e,this.name_=s,this.useClassification_=r}get value(){return this}get text(){return this.name_}set text(t){this.name_=t}get useClassification(){return this.useClassification_}set useClassification(t){this.useClassification_=t}get key(){return this.key_}set key(t){this.key_=t}get id(){return this.id_}set id(t){this.id_=t}get name(){return this.name_}set name(t){this.name_=t}}class a{static async load(){const t=[],e=await browser.storage.sync.get("tags"),s=await browser.messages.listTags();return null!=s&&s.forEach((s,a)=>{let i=!1;null!=e.tags&&e.tags.indexOf(s.key)>=0&&(i=!0),t.push(new r(a,s.key,s.tag,i))}),t}static async save(t){const e=[];for(const s of t)e.push(s.key);await browser.storage.sync.set({tags:e})}}},157:function(t,e,s){!function(t){"use strict";function e(t){if(0===t.length)return 0;for(var e,s=t[0],r=0,a=1;a<t.length;a++)e=s+t[a],Math.abs(s)>=Math.abs(t[a])?r+=s-e+t[a]:r+=t[a]-e+s,s=e;return s+r}function s(t){if(0===t.length)throw new Error("mean requires at least one data point");return e(t)/t.length}function r(t,e){var r,a,i=s(t),n=0;if(2===e)for(a=0;a<t.length;a++)n+=(r=t[a]-i)*r;else for(a=0;a<t.length;a++)n+=Math.pow(t[a]-i,e);return n}function a(t){if(0===t.length)throw new Error("variance requires at least one data point");return r(t,2)/t.length}function i(t){if(1===t.length)return 0;var e=a(t);return Math.sqrt(e)}function n(t){if(0===t.length)throw new Error("mode requires at least one data point");if(1===t.length)return t[0];for(var e=t[0],s=NaN,r=0,a=1,i=1;i<t.length+1;i++)t[i]!==e?(a>r&&(r=a,s=e),a=1,e=t[i]):a++;return s}function o(t){return t.slice().sort((function(t,e){return t-e}))}function g(t){if(0===t.length)throw new Error("min requires at least one data point");for(var e=t[0],s=1;s<t.length;s++)t[s]<e&&(e=t[s]);return e}function l(t){if(0===t.length)throw new Error("max requires at least one data point");for(var e=t[0],s=1;s<t.length;s++)t[s]>e&&(e=t[s]);return e}function c(t){for(var e=0,s=0;s<t.length;s++)e+=t[s];return e}function h(t,e){var s=t.length*e;if(0===t.length)throw new Error("quantile requires at least one data point.");if(e<0||e>1)throw new Error("quantiles must be between 0 and 1");return 1===e?t[t.length-1]:0===e?t[0]:s%1!=0?t[Math.ceil(s)-1]:t.length%2==0?(t[s-1]+t[s])/2:t[s]}function u(t,e,s,r){for(s=s||0,r=r||t.length-1;r>s;){if(r-s>600){var a=r-s+1,i=e-s+1,n=Math.log(a),o=.5*Math.exp(2*n/3),g=.5*Math.sqrt(n*o*(a-o)/a);i-a/2<0&&(g*=-1),u(t,e,Math.max(s,Math.floor(e-i*o/a+g)),Math.min(r,Math.floor(e+(a-i)*o/a+g)))}var l=t[e],c=s,h=r;for(m(t,s,e),t[r]>l&&m(t,s,r);c<h;){for(m(t,c,h),c++,h--;t[c]<l;)c++;for(;t[h]>l;)h--}t[s]===l?m(t,s,h):m(t,++h,r),h<=e&&(s=h+1),e<=h&&(r=h-1)}}function m(t,e,s){var r=t[e];t[e]=t[s],t[s]=r}function f(t,e){var s=t.slice();if(Array.isArray(e)){!function(t,e){for(var s=[0],r=0;r<e.length;r++)s.push(_(t.length,e[r]));s.push(t.length-1),s.sort(A);for(var a=[0,s.length-1];a.length;){var i=Math.ceil(a.pop()),n=Math.floor(a.pop());if(!(i-n<=1)){var o=Math.floor((n+i)/2);d(t,s[o],Math.floor(s[n]),Math.ceil(s[i])),a.push(n,o,o,i)}}}(s,e);for(var r=[],a=0;a<e.length;a++)r[a]=h(s,e[a]);return r}return d(s,_(s.length,e),0,s.length-1),h(s,e)}function d(t,e,s,r){e%1==0?u(t,e,s,r):(u(t,e=Math.floor(e),s,r),u(t,e+1,e+1,r))}function A(t,e){return t-e}function _(t,e){var s=t*e;return 1===e?t-1:0===e?0:s%1!=0?Math.ceil(s)-1:t%2==0?s-.5:s}function w(t,e){if(e<t[0])return 0;if(e>t[t.length-1])return 1;var s=function(t,e){for(var s=0,r=0,a=t.length;r<a;)e<=t[s=r+a>>>1]?a=s:r=-~s;return r}(t,e);if(t[s]!==e)return s/t.length;s++;var r=function(t,e){for(var s=0,r=0,a=t.length;r<a;)e>=t[s=r+a>>>1]?r=-~s:a=s;return r}(t,e);if(r===s)return s/t.length;var a=r-s+1;return a*(r+s)/2/a/t.length}function p(t){var e=f(t,.75),s=f(t,.25);if("number"==typeof e&&"number"==typeof s)return e-s}function v(t){return+f(t,.5)}function b(t){for(var e=v(t),s=[],r=0;r<t.length;r++)s.push(Math.abs(t[r]-e));return v(s)}function x(t,e){e=e||Math.random;for(var s,r,a=t.length;a>0;)r=Math.floor(e()*a--),s=t[a],t[a]=t[r],t[r]=s;return t}function y(t,e){return x(t.slice().slice(),e)}function M(t){for(var e,s=0,r=0;r<t.length;r++)0!==r&&t[r]===e||(e=t[r],s++);return s}function I(t,e){for(var s=[],r=0;r<t;r++){for(var a=[],i=0;i<e;i++)a.push(0);s.push(a)}return s}function H(t,e,s,r){var a;if(t>0){var i=(s[e]-s[t-1])/(e-t+1);a=r[e]-r[t-1]-(e-t+1)*i*i}else a=r[e]-s[e]*s[e]/(e+1);return a<0?0:a}function O(t,e,s,r,a,i,n){if(!(t>e)){var o=Math.floor((t+e)/2);r[s][o]=r[s-1][o-1],a[s][o]=o;var g=s;t>s&&(g=Math.max(g,a[s][t-1]||0)),g=Math.max(g,a[s-1][o]||0);var l,c,h,u=o-1;e<r.length-1&&(u=Math.min(u,a[s][e+1]||0));for(var m=u;m>=g&&!((l=H(m,o,i,n))+r[s-1][g-1]>=r[s][o]);--m)(c=H(g,o,i,n)+r[s-1][g-1])<r[s][o]&&(r[s][o]=c,a[s][o]=g),g++,(h=l+r[s-1][m-1])<r[s][o]&&(r[s][o]=h,a[s][o]=m);O(t,o-1,s,r,a,i,n),O(o+1,e,s,r,a,i,n)}}function T(t,e){if(t.length!==e.length)throw new Error("sampleCovariance requires samples with equal lengths");if(t.length<2)throw new Error("sampleCovariance requires at least two data points in each sample");for(var r=s(t),a=s(e),i=0,n=0;n<t.length;n++)i+=(t[n]-r)*(e[n]-a);return i/(t.length-1)}function S(t){if(t.length<2)throw new Error("sampleVariance requires at least two data points");return r(t,2)/(t.length-1)}function C(t){var e=S(t);return Math.sqrt(e)}function E(t,e,s,r){return(t*e+s*r)/(e+r)}function B(t){if(0===t.length)throw new Error("meanSimple requires at least one data point");return c(t)/t.length}function L(t){if(0===t.length)throw new Error("rootMeanSquare requires at least one data point");for(var e=0,s=0;s<t.length;s++)e+=Math.pow(t[s],2);return Math.sqrt(e/t.length)}var k=function(){this.totalCount=0,this.data={}};k.prototype.train=function(t,e){for(var s in this.data[e]||(this.data[e]={}),t){var r=t[s];void 0===this.data[e][s]&&(this.data[e][s]={}),void 0===this.data[e][s][r]&&(this.data[e][s][r]=0),this.data[e][s][r]++}this.totalCount++},k.prototype.score=function(t){var e,s={};for(var r in t){var a=t[r];for(e in this.data)s[e]={},this.data[e][r]?s[e][r+"_"+a]=(this.data[e][r][a]||0)/this.totalCount:s[e][r+"_"+a]=0}var i={};for(e in s)for(var n in i[e]=0,s[e])i[e]+=s[e][n];return i};var P=function(){this.weights=[],this.bias=0};function N(t){if(t<0)throw new Error("factorial requires a non-negative value");if(Math.floor(t)!==t)throw new Error("factorial requires an integer input");for(var e=1,s=2;s<=t;s++)e*=s;return e}P.prototype.predict=function(t){if(t.length!==this.weights.length)return null;for(var e=0,s=0;s<this.weights.length;s++)e+=this.weights[s]*t[s];return(e+=this.bias)>0?1:0},P.prototype.train=function(t,e){if(0!==e&&1!==e)return null;t.length!==this.weights.length&&(this.weights=t,this.bias=1);var s=this.predict(t);if("number"==typeof s&&s!==e){for(var r=e-s,a=0;a<this.weights.length;a++)this.weights[a]+=r*t[a];this.bias+=r}return this};var K=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],R=Math.log(Math.sqrt(2*Math.PI)),q={1:{.995:0,.99:0,.975:0,.95:0,.9:.02,.5:.45,.1:2.71,.05:3.84,.025:5.02,.01:6.63,.005:7.88},2:{.995:.01,.99:.02,.975:.05,.95:.1,.9:.21,.5:1.39,.1:4.61,.05:5.99,.025:7.38,.01:9.21,.005:10.6},3:{.995:.07,.99:.11,.975:.22,.95:.35,.9:.58,.5:2.37,.1:6.25,.05:7.81,.025:9.35,.01:11.34,.005:12.84},4:{.995:.21,.99:.3,.975:.48,.95:.71,.9:1.06,.5:3.36,.1:7.78,.05:9.49,.025:11.14,.01:13.28,.005:14.86},5:{.995:.41,.99:.55,.975:.83,.95:1.15,.9:1.61,.5:4.35,.1:9.24,.05:11.07,.025:12.83,.01:15.09,.005:16.75},6:{.995:.68,.99:.87,.975:1.24,.95:1.64,.9:2.2,.5:5.35,.1:10.65,.05:12.59,.025:14.45,.01:16.81,.005:18.55},7:{.995:.99,.99:1.25,.975:1.69,.95:2.17,.9:2.83,.5:6.35,.1:12.02,.05:14.07,.025:16.01,.01:18.48,.005:20.28},8:{.995:1.34,.99:1.65,.975:2.18,.95:2.73,.9:3.49,.5:7.34,.1:13.36,.05:15.51,.025:17.53,.01:20.09,.005:21.96},9:{.995:1.73,.99:2.09,.975:2.7,.95:3.33,.9:4.17,.5:8.34,.1:14.68,.05:16.92,.025:19.02,.01:21.67,.005:23.59},10:{.995:2.16,.99:2.56,.975:3.25,.95:3.94,.9:4.87,.5:9.34,.1:15.99,.05:18.31,.025:20.48,.01:23.21,.005:25.19},11:{.995:2.6,.99:3.05,.975:3.82,.95:4.57,.9:5.58,.5:10.34,.1:17.28,.05:19.68,.025:21.92,.01:24.72,.005:26.76},12:{.995:3.07,.99:3.57,.975:4.4,.95:5.23,.9:6.3,.5:11.34,.1:18.55,.05:21.03,.025:23.34,.01:26.22,.005:28.3},13:{.995:3.57,.99:4.11,.975:5.01,.95:5.89,.9:7.04,.5:12.34,.1:19.81,.05:22.36,.025:24.74,.01:27.69,.005:29.82},14:{.995:4.07,.99:4.66,.975:5.63,.95:6.57,.9:7.79,.5:13.34,.1:21.06,.05:23.68,.025:26.12,.01:29.14,.005:31.32},15:{.995:4.6,.99:5.23,.975:6.27,.95:7.26,.9:8.55,.5:14.34,.1:22.31,.05:25,.025:27.49,.01:30.58,.005:32.8},16:{.995:5.14,.99:5.81,.975:6.91,.95:7.96,.9:9.31,.5:15.34,.1:23.54,.05:26.3,.025:28.85,.01:32,.005:34.27},17:{.995:5.7,.99:6.41,.975:7.56,.95:8.67,.9:10.09,.5:16.34,.1:24.77,.05:27.59,.025:30.19,.01:33.41,.005:35.72},18:{.995:6.26,.99:7.01,.975:8.23,.95:9.39,.9:10.87,.5:17.34,.1:25.99,.05:28.87,.025:31.53,.01:34.81,.005:37.16},19:{.995:6.84,.99:7.63,.975:8.91,.95:10.12,.9:11.65,.5:18.34,.1:27.2,.05:30.14,.025:32.85,.01:36.19,.005:38.58},20:{.995:7.43,.99:8.26,.975:9.59,.95:10.85,.9:12.44,.5:19.34,.1:28.41,.05:31.41,.025:34.17,.01:37.57,.005:40},21:{.995:8.03,.99:8.9,.975:10.28,.95:11.59,.9:13.24,.5:20.34,.1:29.62,.05:32.67,.025:35.48,.01:38.93,.005:41.4},22:{.995:8.64,.99:9.54,.975:10.98,.95:12.34,.9:14.04,.5:21.34,.1:30.81,.05:33.92,.025:36.78,.01:40.29,.005:42.8},23:{.995:9.26,.99:10.2,.975:11.69,.95:13.09,.9:14.85,.5:22.34,.1:32.01,.05:35.17,.025:38.08,.01:41.64,.005:44.18},24:{.995:9.89,.99:10.86,.975:12.4,.95:13.85,.9:15.66,.5:23.34,.1:33.2,.05:36.42,.025:39.36,.01:42.98,.005:45.56},25:{.995:10.52,.99:11.52,.975:13.12,.95:14.61,.9:16.47,.5:24.34,.1:34.28,.05:37.65,.025:40.65,.01:44.31,.005:46.93},26:{.995:11.16,.99:12.2,.975:13.84,.95:15.38,.9:17.29,.5:25.34,.1:35.56,.05:38.89,.025:41.92,.01:45.64,.005:48.29},27:{.995:11.81,.99:12.88,.975:14.57,.95:16.15,.9:18.11,.5:26.34,.1:36.74,.05:40.11,.025:43.19,.01:46.96,.005:49.65},28:{.995:12.46,.99:13.57,.975:15.31,.95:16.93,.9:18.94,.5:27.34,.1:37.92,.05:41.34,.025:44.46,.01:48.28,.005:50.99},29:{.995:13.12,.99:14.26,.975:16.05,.95:17.71,.9:19.77,.5:28.34,.1:39.09,.05:42.56,.025:45.72,.01:49.59,.005:52.34},30:{.995:13.79,.99:14.95,.975:16.79,.95:18.49,.9:20.6,.5:29.34,.1:40.26,.05:43.77,.025:46.98,.01:50.89,.005:53.67},40:{.995:20.71,.99:22.16,.975:24.43,.95:26.51,.9:29.05,.5:39.34,.1:51.81,.05:55.76,.025:59.34,.01:63.69,.005:66.77},50:{.995:27.99,.99:29.71,.975:32.36,.95:34.76,.9:37.69,.5:49.33,.1:63.17,.05:67.5,.025:71.42,.01:76.15,.005:79.49},60:{.995:35.53,.99:37.48,.975:40.48,.95:43.19,.9:46.46,.5:59.33,.1:74.4,.05:79.08,.025:83.3,.01:88.38,.005:91.95},70:{.995:43.28,.99:45.44,.975:48.76,.95:51.74,.9:55.33,.5:69.33,.1:85.53,.05:90.53,.025:95.02,.01:100.42,.005:104.22},80:{.995:51.17,.99:53.54,.975:57.15,.95:60.39,.9:64.28,.5:79.33,.1:96.58,.05:101.88,.025:106.63,.01:112.33,.005:116.32},90:{.995:59.2,.99:61.75,.975:65.65,.95:69.13,.9:73.29,.5:89.33,.1:107.57,.05:113.14,.025:118.14,.01:124.12,.005:128.3},100:{.995:67.33,.99:70.06,.975:74.22,.95:77.93,.9:82.36,.5:99.33,.1:118.5,.05:124.34,.025:129.56,.01:135.81,.005:140.17}},D=Math.sqrt(2*Math.PI),U={gaussian:function(t){return Math.exp(-.5*t*t)/D}},W={nrd:function(t){var e=C(t),s=p(t);return"number"==typeof s&&(e=Math.min(e,s/1.34)),1.06*e*Math.pow(t.length,-.2)}};function j(t,e,s){var r,a;if(void 0===e)r=U.gaussian;else if("string"==typeof e){if(!U[e])throw new Error('Unknown kernel "'+e+'"');r=U[e]}else r=e;if(void 0===s)a=W.nrd(t);else if("string"==typeof s){if(!W[s])throw new Error('Unknown bandwidth method "'+s+'"');a=W[s](t)}else a=s;return function(e){var s=0,i=0;for(s=0;s<t.length;s++)i+=r((e-t[s])/a);return i/a/t.length}}var F=Math.sqrt(2*Math.PI);function Q(t){for(var e=t,s=t,r=1;r<15;r++)e+=s*=t*t/(2*r+1);return Math.round(1e4*(.5+e/F*Math.exp(-t*t/2)))/1e4}for(var $=[],Y=0;Y<=3.09;Y+=.01)$.push(Q(Y));function G(t){var e=1/(1+.5*Math.abs(t)),s=e*Math.exp(-t*t+((((((((.17087277*e-.82215223)*e+1.48851587)*e-1.13520398)*e+.27886807)*e-.18628806)*e+.09678418)*e+.37409196)*e+1.00002368)*e-1.26551223);return t>=0?1-s:s-1}function V(t){var e=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),s=Math.sqrt(Math.sqrt(Math.pow(2/(Math.PI*e)+Math.log(1-t*t)/2,2)-Math.log(1-t*t)/e)-(2/(Math.PI*e)+Math.log(1-t*t)/2));return t>=0?s:-s}function z(t){if("number"==typeof t)return t<0?-1:0===t?0:1;throw new TypeError("not a number")}t.BayesianClassifier=k,t.PerceptronModel=P,t.addToMean=function(t,e,s){return t+(s-t)/(e+1)},t.average=s,t.averageSimple=B,t.bayesian=k,t.bernoulliDistribution=function(t){if(t<0||t>1)throw new Error("bernoulliDistribution requires probability to be between 0 and 1 inclusive");return[1-t,t]},t.binomialDistribution=function(t,e){if(!(e<0||e>1||t<=0||t%1!=0)){var s=0,r=0,a=[],i=1;do{a[s]=i*Math.pow(e,s)*Math.pow(1-e,t-s),r+=a[s],i=i*(t-++s+1)/s}while(r<.9999);return a}},t.bisect=function(t,e,s,r,a){if("function"!=typeof t)throw new TypeError("func must be a function");for(var i=0;i<r;i++){var n=(e+s)/2;if(0===t(n)||Math.abs((s-e)/2)<a)return n;z(t(n))===z(t(e))?e=n:s=n}throw new Error("maximum number of iterations exceeded")},t.chiSquaredDistributionTable=q,t.chiSquaredGoodnessOfFit=function(t,e,r){for(var a=0,i=e(s(t)),n=[],o=[],g=0;g<t.length;g++)void 0===n[t[g]]&&(n[t[g]]=0),n[t[g]]++;for(var l=0;l<n.length;l++)void 0===n[l]&&(n[l]=0);for(var c in i)c in n&&(o[+c]=i[c]*t.length);for(var h=o.length-1;h>=0;h--)o[h]<3&&(o[h-1]+=o[h],o.pop(),n[h-1]+=n[h],n.pop());for(var u=0;u<n.length;u++)a+=Math.pow(n[u]-o[u],2)/o[u];var m=n.length-1-1;return q[m][r]<a},t.chunk=function(t,e){var s=[];if(e<1)throw new Error("chunk size must be a positive number");if(Math.floor(e)!==e)throw new Error("chunk size must be an integer");for(var r=0;r<t.length;r+=e)s.push(t.slice(r,r+e));return s},t.ckmeans=function(t,e){if(e>t.length)throw new Error("cannot generate more classes than there are data values");var s=o(t);if(1===M(s))return[s];var r=I(e,s.length),a=I(e,s.length);!function(t,e,s){for(var r=e[0].length,a=t[Math.floor(r/2)],i=[],n=[],o=0,g=void 0;o<r;++o)g=t[o]-a,0===o?(i.push(g),n.push(g*g)):(i.push(i[o-1]+g),n.push(n[o-1]+g*g)),e[0][o]=H(0,o,i,n),s[0][o]=0;for(var l=1;l<e.length;++l)O(l<e.length-1?l:r-1,r-1,l,e,s,i,n)}(s,r,a);for(var i=[],n=a[0].length-1,g=a.length-1;g>=0;g--){var l=a[g][n];i[g]=s.slice(l,n+1),g>0&&(n=l-1)}return i},t.combinations=function t(e,s){var r,a,i,n,o=[];for(r=0;r<e.length;r++)if(1===s)o.push([e[r]]);else for(i=t(e.slice(r+1,e.length),s-1),a=0;a<i.length;a++)(n=i[a]).unshift(e[r]),o.push(n);return o},t.combinationsReplacement=function t(e,s){for(var r=[],a=0;a<e.length;a++)if(1===s)r.push([e[a]]);else for(var i=t(e.slice(a,e.length),s-1),n=0;n<i.length;n++)r.push([e[a]].concat(i[n]));return r},t.combineMeans=E,t.combineVariances=function(t,e,s,r,a,i){var n=E(e,s,a,i);return(s*(t+Math.pow(e-n,2))+i*(r+Math.pow(a-n,2)))/(s+i)},t.cumulativeStdNormalProbability=function(t){var e=Math.abs(t),s=Math.min(Math.round(100*e),$.length-1);return t>=0?$[s]:+(1-$[s]).toFixed(4)},t.epsilon=1e-4,t.equalIntervalBreaks=function(t,e){if(t.length<2)return t;for(var s=g(t),r=l(t),a=[s],i=(r-s)/e,n=1;n<e;n++)a.push(a[0]+i*n);return a.push(r),a},t.erf=G,t.errorFunction=G,t.extent=function(t){if(0===t.length)throw new Error("extent requires at least one data point");for(var e=t[0],s=t[0],r=1;r<t.length;r++)t[r]>s&&(s=t[r]),t[r]<e&&(e=t[r]);return[e,s]},t.extentSorted=function(t){return[t[0],t[t.length-1]]},t.factorial=N,t.gamma=function t(e){if(Number.isInteger(e))return e<=0?NaN:N(e-1);if(--e<0)return Math.PI/(Math.sin(Math.PI*-e)*t(-e));var s=e+1/4;return Math.pow(e/Math.E,e)*Math.sqrt(2*Math.PI*(e+1/6))*(1+1/144/Math.pow(s,2)-1/12960/Math.pow(s,3)-257/207360/Math.pow(s,4)-52/2612736/Math.pow(s,5)+5741173/9405849600/Math.pow(s,6)+37529/18811699200/Math.pow(s,7))},t.gammaln=function(t){if(t<=0)return 1/0;t--;for(var e=K[0],s=1;s<15;s++)e+=K[s]/(t+s);var r=5.2421875+t;return R+Math.log(e)-r+(t+.5)*Math.log(r)},t.geometricMean=function(t){if(0===t.length)throw new Error("geometricMean requires at least one data point");for(var e=1,s=0;s<t.length;s++){if(t[s]<=0)throw new Error("geometricMean requires only positive numbers as input");e*=t[s]}return Math.pow(e,1/t.length)},t.harmonicMean=function(t){if(0===t.length)throw new Error("harmonicMean requires at least one data point");for(var e=0,s=0;s<t.length;s++){if(t[s]<=0)throw new Error("harmonicMean requires only positive numbers as input");e+=1/t[s]}return t.length/e},t.interquartileRange=p,t.inverseErrorFunction=V,t.iqr=p,t.kde=j,t.kernelDensityEstimation=j,t.linearRegression=function(t){var e,s,r=t.length;if(1===r)e=0,s=t[0][1];else{for(var a,i,n,o=0,g=0,l=0,c=0,h=0;h<r;h++)o+=i=(a=t[h])[0],g+=n=a[1],l+=i*i,c+=i*n;s=g/r-(e=(r*c-o*g)/(r*l-o*o))*o/r}return{m:e,b:s}},t.linearRegressionLine=function(t){return function(e){return t.b+t.m*e}},t.mad=b,t.max=l,t.maxSorted=function(t){return t[t.length-1]},t.mean=s,t.meanSimple=B,t.median=v,t.medianAbsoluteDeviation=b,t.medianSorted=function(t){return h(t,.5)},t.min=g,t.minSorted=function(t){return t[0]},t.mode=function(t){return n(o(t))},t.modeFast=function(t){for(var e,s=new Map,r=0,a=0;a<t.length;a++){var i=s.get(t[a]);void 0===i?i=1:i++,i>r&&(e=t[a],r=i),s.set(t[a],i)}if(0===r)throw new Error("mode requires at last one data point");return e},t.modeSorted=n,t.numericSort=o,t.perceptron=P,t.permutationTest=function(t,e,r,a){if(void 0===a&&(a=1e4),void 0===r&&(r="two_side"),"two_side"!==r&&"greater"!==r&&"less"!==r)throw new Error("`alternative` must be either 'two_side', 'greater', or 'less'");for(var i=s(t)-s(e),n=new Array(a),o=t.concat(e),g=Math.floor(o.length/2),l=0;l<a;l++){x(o);var c=o.slice(0,g),h=o.slice(g,o.length),u=s(c)-s(h);n[l]=u}var m=0;if("two_side"===r)for(var f=0;f<=a;f++)Math.abs(n[f])>=Math.abs(i)&&(m+=1);else if("greater"===r)for(var d=0;d<=a;d++)n[d]>=i&&(m+=1);else for(var A=0;A<=a;A++)n[A]<=i&&(m+=1);return m/a},t.permutationsHeap=function(t){for(var e=new Array(t.length),s=[t.slice()],r=0;r<t.length;r++)e[r]=0;for(var a=0;a<t.length;)if(e[a]<a){var i=0;a%2!=0&&(i=e[a]);var n=t[i];t[i]=t[a],t[a]=n,s.push(t.slice()),e[a]++,a=0}else e[a]=0,a++;return s},t.poissonDistribution=function(t){if(!(t<=0)){var e=0,s=0,r=[],a=1;do{r[e]=Math.exp(-t)*Math.pow(t,e)/a,s+=r[e],a*=++e}while(s<.9999);return r}},t.probit=function(t){return 0===t?t=1e-4:t>=1&&(t=.9999),Math.sqrt(2)*V(2*t-1)},t.product=function(t){for(var e=1,s=0;s<t.length;s++)e*=t[s];return e},t.quantile=f,t.quantileRank=function(t,e){return w(o(t),e)},t.quantileRankSorted=w,t.quantileSorted=h,t.quickselect=u,t.rSquared=function(t,e){if(t.length<2)return 1;for(var s=0,r=0;r<t.length;r++)s+=t[r][1];for(var a=s/t.length,i=0,n=0;n<t.length;n++)i+=Math.pow(a-t[n][1],2);for(var o=0,g=0;g<t.length;g++)o+=Math.pow(t[g][1]-e(t[g][0]),2);return 1-o/i},t.rms=L,t.rootMeanSquare=L,t.sample=function(t,e,s){return y(t,s).slice(0,e)},t.sampleCorrelation=function(t,e){return T(t,e)/C(t)/C(e)},t.sampleCovariance=T,t.sampleKurtosis=function(t){var e=t.length;if(e<4)throw new Error("sampleKurtosis requires at least four data points");for(var r,a=s(t),i=0,n=0,o=0;o<e;o++)i+=(r=t[o]-a)*r,n+=r*r*r*r;return(e-1)/((e-2)*(e-3))*(e*(e+1)*n/(i*i)-3*(e-1))},t.sampleSkewness=function(t){if(t.length<3)throw new Error("sampleSkewness requires at least three data points");for(var e,r=s(t),a=0,i=0,n=0;n<t.length;n++)a+=(e=t[n]-r)*e,i+=e*e*e;var o=t.length-1,g=Math.sqrt(a/o),l=t.length;return l*i/((l-1)*(l-2)*Math.pow(g,3))},t.sampleStandardDeviation=C,t.sampleVariance=S,t.sampleWithReplacement=function(t,e,s){if(0===t.length)return[];s=s||Math.random;for(var r=t.length,a=[],i=0;i<e;i++){var n=Math.floor(s()*r);a.push(t[n])}return a},t.shuffle=y,t.shuffleInPlace=x,t.sign=z,t.standardDeviation=i,t.standardNormalTable=$,t.subtractFromMean=function(t,e,s){return(t*e-s)/(e-1)},t.sum=e,t.sumNthPowerDeviations=r,t.sumSimple=c,t.tTest=function(t,e){return(s(t)-e)/(i(t)/Math.sqrt(t.length))},t.tTestTwoSample=function(t,e,r){var a=t.length,i=e.length;if(!a||!i)return null;r||(r=0);var n=s(t),o=s(e),g=S(t),l=S(e);if("number"==typeof n&&"number"==typeof o&&"number"==typeof g&&"number"==typeof l){var c=((a-1)*g+(i-1)*l)/(a+i-2);return(n-o-r)/Math.sqrt(c*(1/a+1/i))}},t.uniqueCountSorted=M,t.variance=a,t.zScore=function(t,e,s){return(t-e)/s},Object.defineProperty(t,"__esModule",{value:!0})}(e)},158:function(t,e){function s(){var t={"[一二三四五六七八九十百千万億兆]":"M","[一-龠々〆ヵヶ]":"H","[ぁ-ん]":"I","[ァ-ヴーｱ-ﾝﾞｰ]":"K","[a-zA-Zａ-ｚＡ-Ｚ]":"A","[0-9０-９]":"N"};for(var e in this.chartype_=[],t){var s=new RegExp;s.compile(e),this.chartype_.push([s,t[e]])}return this.BIAS__=-332,this.BC1__={HH:6,II:2461,KH:406,OH:-1378},this.BC2__={AA:-3267,AI:2744,AN:-878,HH:-4070,HM:-1711,HN:4012,HO:3761,IA:1327,IH:-1184,II:-1332,IK:1721,IO:5492,KI:3831,KK:-8741,MH:-3132,MK:3334,OO:-2920},this.BC3__={HH:996,HI:626,HK:-721,HN:-1307,HO:-836,IH:-301,KK:2762,MK:1079,MM:4034,OA:-1652,OH:266},this.BP1__={BB:295,OB:304,OO:-125,UB:352},this.BP2__={BO:60,OO:-1762},this.BQ1__={BHH:1150,BHM:1521,BII:-1158,BIM:886,BMH:1208,BNH:449,BOH:-91,BOO:-2597,OHI:451,OIH:-296,OKA:1851,OKH:-1020,OKK:904,OOO:2965},this.BQ2__={BHH:118,BHI:-1159,BHM:466,BIH:-919,BKK:-1720,BKO:864,OHH:-1139,OHM:-181,OIH:153,UHI:-1146},this.BQ3__={BHH:-792,BHI:2664,BII:-299,BKI:419,BMH:937,BMM:8335,BNN:998,BOH:775,OHH:2174,OHM:439,OII:280,OKH:1798,OKI:-793,OKO:-2242,OMH:-2402,OOO:11699},this.BQ4__={BHH:-3895,BIH:3761,BII:-4654,BIK:1348,BKK:-1806,BMI:-3385,BOO:-12396,OAH:926,OHH:266,OHK:-2036,ONN:-973},this.BW1__={",と":660,",同":727,B1あ:1404,B1同:542,"、と":660,"、同":727,"」と":1682,あっ:1505,いう:1743,いっ:-2055,いる:672,うし:-4817,うん:665,から:3472,がら:600,こう:-790,こと:2083,こん:-1262,さら:-4143,さん:4573,した:2641,して:1104,すで:-3399,そこ:1977,それ:-871,たち:1122,ため:601,った:3463,つい:-802,てい:805,てき:1249,でき:1127,です:3445,では:844,とい:-4915,とみ:1922,どこ:3887,ない:5713,なっ:3015,など:7379,なん:-1113,にし:2468,には:1498,にも:1671,に対:-912,の一:-501,の中:741,ませ:2448,まで:1711,まま:2600,まる:-2155,やむ:-1947,よっ:-2565,れた:2369,れで:-913,をし:1860,を見:731,亡く:-1886,京都:2558,取り:-2784,大き:-2604,大阪:1497,平方:-2314,引き:-1336,日本:-195,本当:-2423,毎日:-2113,目指:-724,Ｂ１あ:1404,Ｂ１同:542,"｣と":1682},this.BW2__={"..":-11822,11:-669,"――":-5730,"−−":-13175,いう:-1609,うか:2490,かし:-1350,かも:-602,から:-7194,かれ:4612,がい:853,がら:-3198,きた:1941,くな:-1597,こと:-8392,この:-4193,させ:4533,され:13168,さん:-3977,しい:-1819,しか:-545,した:5078,して:972,しな:939,その:-3744,たい:-1253,たた:-662,ただ:-3857,たち:-786,たと:1224,たは:-939,った:4589,って:1647,っと:-2094,てい:6144,てき:3640,てく:2551,ては:-3110,ても:-3065,でい:2666,でき:-1528,でし:-3828,です:-4761,でも:-4203,とい:1890,とこ:-1746,とと:-2279,との:720,とみ:5168,とも:-3941,ない:-2488,なが:-1313,など:-6509,なの:2614,なん:3099,にお:-1615,にし:2748,にな:2454,によ:-7236,に対:-14943,に従:-4688,に関:-11388,のか:2093,ので:-7059,のに:-6041,のの:-6125,はい:1073,はが:-1033,はず:-2532,ばれ:1813,まし:-1316,まで:-6621,まれ:5409,めて:-3153,もい:2230,もの:-10713,らか:-944,らし:-1611,らに:-1897,りし:651,りま:1620,れた:4270,れて:849,れば:4114,ろう:6067,われ:7901,を通:-11877,んだ:728,んな:-4115,一人:602,一方:-1375,一日:970,一部:-1051,上が:-4479,会社:-1116,出て:2163,分の:-7758,同党:970,同日:-913,大阪:-2471,委員:-1250,少な:-1050,年度:-8669,年間:-1626,府県:-2363,手権:-1982,新聞:-4066,日新:-722,日本:-7068,日米:3372,曜日:-601,朝鮮:-2355,本人:-2697,東京:-1543,然と:-1384,社会:-1276,立て:-990,第に:-1612,米国:-4268,"１１":-669},this.BW3__={あた:-2194,あり:719,ある:3846,"い.":-1185,"い。":-1185,いい:5308,いえ:2079,いく:3029,いた:2056,いっ:1883,いる:5600,いわ:1527,うち:1117,うと:4798,えと:1454,"か.":2857,"か。":2857,かけ:-743,かっ:-4098,かに:-669,から:6520,かり:-2670,"が,":1816,"が、":1816,がき:-4855,がけ:-1127,がっ:-913,がら:-4977,がり:-2064,きた:1645,けど:1374,こと:7397,この:1542,ころ:-2757,さい:-714,さを:976,"し,":1557,"し、":1557,しい:-3714,した:3562,して:1449,しな:2608,しま:1200,"す.":-1310,"す。":-1310,する:6521,"ず,":3426,"ず、":3426,ずに:841,そう:428,"た.":8875,"た。":8875,たい:-594,たの:812,たり:-1183,たる:-853,"だ.":4098,"だ。":4098,だっ:1004,った:-4748,って:300,てい:6240,てお:855,ても:302,です:1437,でに:-1482,では:2295,とう:-1387,とし:2266,との:541,とも:-3543,どう:4664,ない:1796,なく:-903,など:2135,"に,":-1021,"に、":-1021,にし:1771,にな:1906,には:2644,"の,":-724,"の、":-724,の子:-1e3,"は,":1337,"は、":1337,べき:2181,まし:1113,ます:6943,まっ:-1549,まで:6154,まれ:-793,らし:1479,られ:6820,るる:3818,"れ,":854,"れ、":854,れた:1850,れて:1375,れば:-3246,れる:1091,われ:-605,んだ:606,んで:798,カ月:990,会議:860,入り:1232,大会:2217,始め:1681,市:965,新聞:-5055,"日,":974,"日、":974,社会:2024,ｶ月:990},this.TC1__={AAA:1093,HHH:1029,HHM:580,HII:998,HOH:-390,HOM:-331,IHI:1169,IOH:-142,IOI:-1015,IOM:467,MMH:187,OOI:-1832},this.TC2__={HHO:2088,HII:-1023,HMM:-1154,IHI:-1965,KKH:703,OII:-2649},this.TC3__={AAA:-294,HHH:346,HHI:-341,HII:-1088,HIK:731,HOH:-1486,IHH:128,IHI:-3041,IHO:-1935,IIH:-825,IIM:-1035,IOI:-542,KHH:-1216,KKA:491,KKH:-1217,KOK:-1009,MHH:-2694,MHM:-457,MHO:123,MMH:-471,NNH:-1689,NNO:662,OHO:-3393},this.TC4__={HHH:-203,HHI:1344,HHK:365,HHM:-122,HHN:182,HHO:669,HIH:804,HII:679,HOH:446,IHH:695,IHO:-2324,IIH:321,III:1497,IIO:656,IOO:54,KAK:4845,KKA:3386,KKK:3065,MHH:-405,MHI:201,MMH:-241,MMM:661,MOM:841},this.TQ1__={BHHH:-227,BHHI:316,BHIH:-132,BIHH:60,BIII:1595,BNHH:-744,BOHH:225,BOOO:-908,OAKK:482,OHHH:281,OHIH:249,OIHI:200,OIIH:-68},this.TQ2__={BIHH:-1401,BIII:-1033,BKAK:-543,BOOO:-5591},this.TQ3__={BHHH:478,BHHM:-1073,BHIH:222,BHII:-504,BIIH:-116,BIII:-105,BMHI:-863,BMHM:-464,BOMH:620,OHHH:346,OHHI:1729,OHII:997,OHMH:481,OIHH:623,OIIH:1344,OKAK:2792,OKHH:587,OKKA:679,OOHH:110,OOII:-685},this.TQ4__={BHHH:-721,BHHM:-3604,BHII:-966,BIIH:-607,BIII:-2181,OAAA:-2763,OAKK:180,OHHH:-294,OHHI:2446,OHHO:480,OHIH:-1573,OIHH:1935,OIHI:-493,OIIH:626,OIII:-4007,OKAK:-8156},this.TW1__={につい:-4681,東京都:2026},this.TW2__={ある程:-2049,いった:-1256,ころが:-2434,しょう:3873,その後:-4430,だって:-1049,ていた:1833,として:-4657,ともに:-4517,もので:1882,一気に:-792,初めて:-1512,同時に:-8097,大きな:-1255,対して:-2721,社会党:-3216},this.TW3__={いただ:-1734,してい:1314,として:-4314,につい:-5483,にとっ:-5989,に当た:-6247,"ので,":-727,"ので、":-727,のもの:-600,れから:-3752,十二月:-2287},this.TW4__={"いう.":8576,"いう。":8576,からな:-2348,してい:2958,"たが,":1516,"たが、":1516,ている:1538,という:1349,ました:5543,ません:1097,ようと:-4258,よると:5865},this.UC1__={A:484,K:93,M:645,O:-505},this.UC2__={A:819,H:1059,I:409,M:3987,N:5775,O:646},this.UC3__={A:-1370,I:2311},this.UC4__={A:-2643,H:1809,I:-1032,K:-3450,M:3565,N:3876,O:6646},this.UC5__={H:313,I:-1238,K:-799,M:539,O:-831},this.UC6__={H:-506,I:-253,K:87,M:247,O:-387},this.UP1__={O:-214},this.UP2__={B:69,O:935},this.UP3__={B:189},this.UQ1__={BH:21,BI:-12,BK:-99,BN:142,BO:-56,OH:-95,OI:477,OK:410,OO:-2422},this.UQ2__={BH:216,BI:113,OK:1759},this.UQ3__={BA:-479,BH:42,BI:1913,BK:-7198,BM:3160,BN:6427,BO:14761,OI:-827,ON:-3212},this.UW1__={",":156,"、":156,"「":-463,あ:-941,う:-127,が:-553,き:121,こ:505,で:-201,と:-547,ど:-123,に:-789,の:-185,は:-847,も:-466,や:-470,よ:182,ら:-292,り:208,れ:169,を:-446,ん:-137,"・":-135,主:-402,京:-268,区:-912,午:871,国:-460,大:561,委:729,市:-411,日:-141,理:361,生:-408,県:-386,都:-718,"｢":-463,"･":-135},this.UW2__={",":-829,"、":-829,〇:892,"「":-645,"」":3145,あ:-538,い:505,う:134,お:-502,か:1454,が:-856,く:-412,こ:1141,さ:878,ざ:540,し:1529,す:-675,せ:300,そ:-1011,た:188,だ:1837,つ:-949,て:-291,で:-268,と:-981,ど:1273,な:1063,に:-1764,の:130,は:-409,ひ:-1273,べ:1261,ま:600,も:-1263,や:-402,よ:1639,り:-579,る:-694,れ:571,を:-2516,ん:2095,ア:-587,カ:306,キ:568,ッ:831,三:-758,不:-2150,世:-302,中:-968,主:-861,事:492,人:-123,会:978,保:362,入:548,初:-3025,副:-1566,北:-3414,区:-422,大:-1769,天:-865,太:-483,子:-1519,学:760,実:1023,小:-2009,市:-813,年:-1060,強:1067,手:-1519,揺:-1033,政:1522,文:-1355,新:-1682,日:-1815,明:-1462,最:-630,朝:-1843,本:-1650,東:-931,果:-665,次:-2378,民:-180,気:-1740,理:752,発:529,目:-1584,相:-242,県:-1165,立:-763,第:810,米:509,自:-1353,行:838,西:-744,見:-3874,調:1010,議:1198,込:3041,開:1758,間:-1257,"｢":-645,"｣":3145,ｯ:831,ｱ:-587,ｶ:306,ｷ:568},this.UW3__={",":4889,1:-800,"−":-1723,"、":4889,々:-2311,〇:5827,"」":2670,"〓":-3573,あ:-2696,い:1006,う:2342,え:1983,お:-4864,か:-1163,が:3271,く:1004,け:388,げ:401,こ:-3552,ご:-3116,さ:-1058,し:-395,す:584,せ:3685,そ:-5228,た:842,ち:-521,っ:-1444,つ:-1081,て:6167,で:2318,と:1691,ど:-899,な:-2788,に:2745,の:4056,は:4555,ひ:-2171,ふ:-1798,へ:1199,ほ:-5516,ま:-4384,み:-120,め:1205,も:2323,や:-788,よ:-202,ら:727,り:649,る:5905,れ:2773,わ:-1207,を:6620,ん:-518,ア:551,グ:1319,ス:874,ッ:-1350,ト:521,ム:1109,ル:1591,ロ:2201,ン:278,"・":-3794,一:-1619,下:-1759,世:-2087,両:3815,中:653,主:-758,予:-1193,二:974,人:2742,今:792,他:1889,以:-1368,低:811,何:4265,作:-361,保:-2439,元:4858,党:3593,全:1574,公:-3030,六:755,共:-1880,円:5807,再:3095,分:457,初:2475,別:1129,前:2286,副:4437,力:365,動:-949,務:-1872,化:1327,北:-1038,区:4646,千:-2309,午:-783,協:-1006,口:483,右:1233,各:3588,合:-241,同:3906,和:-837,員:4513,国:642,型:1389,場:1219,外:-241,妻:2016,学:-1356,安:-423,実:-1008,家:1078,小:-513,少:-3102,州:1155,市:3197,平:-1804,年:2416,広:-1030,府:1605,度:1452,建:-2352,当:-3885,得:1905,思:-1291,性:1822,戸:-488,指:-3973,政:-2013,教:-1479,数:3222,文:-1489,新:1764,日:2099,旧:5792,昨:-661,時:-1248,曜:-951,最:-937,月:4125,期:360,李:3094,村:364,東:-805,核:5156,森:2438,業:484,氏:2613,民:-1694,決:-1073,法:1868,海:-495,無:979,物:461,特:-3850,生:-273,用:914,町:1215,的:7313,直:-1835,省:792,県:6293,知:-1528,私:4231,税:401,立:-960,第:1201,米:7767,系:3066,約:3663,級:1384,統:-4229,総:1163,線:1255,者:6457,能:725,自:-2869,英:785,見:1044,調:-562,財:-733,費:1777,車:1835,軍:1375,込:-1504,通:-1136,選:-681,郎:1026,郡:4404,部:1200,金:2163,長:421,開:-1432,間:1302,関:-1282,雨:2009,電:-1045,非:2066,駅:1620,"１":-800,"｣":2670,"･":-3794,ｯ:-1350,ｱ:551,ｸﾞ:1319,ｽ:874,ﾄ:521,ﾑ:1109,ﾙ:1591,ﾛ:2201,ﾝ:278},this.UW4__={",":3930,".":3508,"―":-4841,"、":3930,"。":3508,〇:4999,"「":1895,"」":3798,"〓":-5156,あ:4752,い:-3435,う:-640,え:-2514,お:2405,か:530,が:6006,き:-4482,ぎ:-3821,く:-3788,け:-4376,げ:-4734,こ:2255,ご:1979,さ:2864,し:-843,じ:-2506,す:-731,ず:1251,せ:181,そ:4091,た:5034,だ:5408,ち:-3654,っ:-5882,つ:-1659,て:3994,で:7410,と:4547,な:5433,に:6499,ぬ:1853,ね:1413,の:7396,は:8578,ば:1940,ひ:4249,び:-4134,ふ:1345,へ:6665,べ:-744,ほ:1464,ま:1051,み:-2082,む:-882,め:-5046,も:4169,ゃ:-2666,や:2795,ょ:-1544,よ:3351,ら:-2922,り:-9726,る:-14896,れ:-2613,ろ:-4570,わ:-1783,を:13150,ん:-2352,カ:2145,コ:1789,セ:1287,ッ:-724,ト:-403,メ:-1635,ラ:-881,リ:-541,ル:-856,ン:-3637,"・":-4371,ー:-11870,一:-2069,中:2210,予:782,事:-190,井:-1768,人:1036,以:544,会:950,体:-1286,作:530,側:4292,先:601,党:-2006,共:-1212,内:584,円:788,初:1347,前:1623,副:3879,力:-302,動:-740,務:-2715,化:776,区:4517,協:1013,参:1555,合:-1834,和:-681,員:-910,器:-851,回:1500,国:-619,園:-1200,地:866,場:-1410,塁:-2094,士:-1413,多:1067,大:571,子:-4802,学:-1397,定:-1057,寺:-809,小:1910,屋:-1328,山:-1500,島:-2056,川:-2667,市:2771,年:374,庁:-4556,後:456,性:553,感:916,所:-1566,支:856,改:787,政:2182,教:704,文:522,方:-856,日:1798,時:1829,最:845,月:-9066,木:-485,来:-442,校:-360,業:-1043,氏:5388,民:-2716,気:-910,沢:-939,済:-543,物:-735,率:672,球:-1267,生:-1286,産:-1101,田:-2900,町:1826,的:2586,目:922,省:-3485,県:2997,空:-867,立:-2112,第:788,米:2937,系:786,約:2171,経:1146,統:-1169,総:940,線:-994,署:749,者:2145,能:-730,般:-852,行:-792,規:792,警:-1184,議:-244,谷:-1e3,賞:730,車:-1481,軍:1158,輪:-1433,込:-3370,近:929,道:-1291,選:2596,郎:-4866,都:1192,野:-1100,銀:-2213,長:357,間:-2344,院:-2297,際:-2604,電:-878,領:-1659,題:-792,館:-1984,首:1749,高:2120,"｢":1895,"｣":3798,"･":-4371,ｯ:-724,ｰ:-11870,ｶ:2145,ｺ:1789,ｾ:1287,ﾄ:-403,ﾒ:-1635,ﾗ:-881,ﾘ:-541,ﾙ:-856,ﾝ:-3637},this.UW5__={",":465,".":-299,1:-514,E2:-32768,"]":-2762,"、":465,"。":-299,"「":363,あ:1655,い:331,う:-503,え:1199,お:527,か:647,が:-421,き:1624,ぎ:1971,く:312,げ:-983,さ:-1537,し:-1371,す:-852,だ:-1186,ち:1093,っ:52,つ:921,て:-18,で:-850,と:-127,ど:1682,な:-787,に:-1224,の:-635,は:-578,べ:1001,み:502,め:865,ゃ:3350,ょ:854,り:-208,る:429,れ:504,わ:419,を:-1264,ん:327,イ:241,ル:451,ン:-343,中:-871,京:722,会:-1153,党:-654,務:3519,区:-901,告:848,員:2104,大:-1296,学:-548,定:1785,嵐:-1304,市:-2991,席:921,年:1763,思:872,所:-814,挙:1618,新:-1682,日:218,月:-4353,査:932,格:1356,機:-1508,氏:-1347,田:240,町:-3912,的:-3149,相:1319,省:-1052,県:-4003,研:-997,社:-278,空:-813,統:1955,者:-2233,表:663,語:-1073,議:1219,選:-1018,郎:-368,長:786,間:1191,題:2368,館:-689,"１":-514,Ｅ２:-32768,"｢":363,ｲ:241,ﾙ:451,ﾝ:-343},this.UW6__={",":227,".":808,1:-270,E1:306,"、":227,"。":808,あ:-307,う:189,か:241,が:-73,く:-121,こ:-200,じ:1782,す:383,た:-428,っ:573,て:-1014,で:101,と:-105,な:-253,に:-149,の:-417,は:-236,も:-206,り:187,る:-135,を:195,ル:-673,ン:-496,一:-277,中:201,件:-800,会:624,前:302,区:1792,員:-1212,委:798,学:-960,市:887,広:-695,後:535,業:-697,相:753,社:-507,福:974,空:-822,者:1811,連:463,郎:1082,"１":-270,Ｅ１:306,ﾙ:-673,ﾝ:-496},this}s.prototype.ctype_=function(t){for(var e in this.chartype_)if(t.match(this.chartype_[e][0]))return this.chartype_[e][1];return"O"},s.prototype.ts_=function(t){return t||0},s.prototype.segment=function(t){if(null==t||null==t||""==t)return[];var e=[],s=["B3","B2","B1"],r=["O","O","O"],a=t.split("");for(l=0;l<a.length;++l)s.push(a[l]),r.push(this.ctype_(a[l]));s.push("E1"),s.push("E2"),s.push("E3"),r.push("O"),r.push("O"),r.push("O");for(var i=s[3],n="U",o="U",g="U",l=4;l<s.length-3;++l){var c=this.BIAS__,h=s[l-3],u=s[l-2],m=s[l-1],f=s[l],d=s[l+1],A=s[l+2],_=r[l-3],w=r[l-2],p=r[l-1],v=r[l],b=r[l+1],x=r[l+2];c+=this.ts_(this.UP1__[n]),c+=this.ts_(this.UP2__[o]),c+=this.ts_(this.UP3__[g]),c+=this.ts_(this.BP1__[n+o]),c+=this.ts_(this.BP2__[o+g]),c+=this.ts_(this.UW1__[h]),c+=this.ts_(this.UW2__[u]),c+=this.ts_(this.UW3__[m]),c+=this.ts_(this.UW4__[f]),c+=this.ts_(this.UW5__[d]),c+=this.ts_(this.UW6__[A]),c+=this.ts_(this.BW1__[u+m]),c+=this.ts_(this.BW2__[m+f]),c+=this.ts_(this.BW3__[f+d]),c+=this.ts_(this.TW1__[h+u+m]),c+=this.ts_(this.TW2__[u+m+f]),c+=this.ts_(this.TW3__[m+f+d]),c+=this.ts_(this.TW4__[f+d+A]),c+=this.ts_(this.UC1__[_]),c+=this.ts_(this.UC2__[w]),c+=this.ts_(this.UC3__[p]),c+=this.ts_(this.UC4__[v]),c+=this.ts_(this.UC5__[b]),c+=this.ts_(this.UC6__[x]),c+=this.ts_(this.BC1__[w+p]),c+=this.ts_(this.BC2__[p+v]),c+=this.ts_(this.BC3__[v+b]),c+=this.ts_(this.TC1__[_+w+p]),c+=this.ts_(this.TC2__[w+p+v]),c+=this.ts_(this.TC3__[p+v+b]),c+=this.ts_(this.TC4__[v+b+x]),c+=this.ts_(this.UQ1__[n+_]),c+=this.ts_(this.UQ2__[o+w]),c+=this.ts_(this.UQ3__[g+p]),c+=this.ts_(this.BQ1__[o+w+p]),c+=this.ts_(this.BQ2__[o+p+v]),c+=this.ts_(this.BQ3__[g+w+p]),c+=this.ts_(this.BQ4__[g+p+v]),c+=this.ts_(this.TQ1__[o+_+w+p]),c+=this.ts_(this.TQ2__[o+w+p+v]),c+=this.ts_(this.TQ3__[g+_+w+p]);var y="O";(c+=this.ts_(this.TQ4__[g+w+p+v]))>0&&(e.push(i),i="",y="B"),n=o,o=g,g=y,i+=s[l]}return e.push(i),e},t.exports=s},160:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return c}));s(11);var r=s(157),a=s(158),i=s.n(a),n=s(12),o=s(20),g=s(8),l=s(4);class c{constructor(){this.tags_=[],this.bodymaxlength_=100,this.totalStatistics_=l.a.getInitialObj(),this.todayStatistics_=l.a.getInitialObj(),this.settingLoaded_=!1,browser.notifications.onClicked.addListener(t=>{switch(t){case c.NOTIFY_ID_NOT_SET:browser.runtime.openOptionsPage(),this.noticeClearNotSetting()}}),browser.runtime.onInstalled.addListener(async({reason:t})=>{switch(t){case"install":{const t=browser.runtime.getURL(browser.i18n.getMessage("homepage"));await browser.tabs.create({url:t})}}}),browser.commands.onCommand.addListener(t=>{switch(t){case"all-classificate":this.executeAllClassificate();break;case"classificate":this.executeClassificate();break;case"view-log":this.executeViewLog();break;case"statsitics":const t={url:"/statistics/statistics.html"};browser.tabs.create(t);break;default:throw new Error("not shortcut define")}}),browser.messages.onNewMailReceived.addListener((t,e)=>{this.executeNewMailClassificate(e)}),browser.storage.onChanged.addListener((t,e)=>{this.storageChangedHook(t,e)}),this.classifier_=new r.BayesianClassifier,this.loadSetting().then(()=>{this.createMenu()})}async storageChangedHook(t,e){if("sync"===e){if("body_max_length"in t&&!1===await this.loadMaxLengthSetting())throw new Error("Changed body_max_length property to undefined.")}else if("tags"in t){if(!1===await this.loadTagSetting())throw new Error("Changed tag property to undefined.");this.createMenu()}}async loadMaxLengthSetting(){const t=await browser.storage.sync.get("body_max_length");return void 0!==t.body_max_length&&(this.bodymaxlength_=t.body_max_length,!0)}async loadTagSetting(){return this.tags_=await n.a.load(),!0}async loadSetting(){if(!1===await this.loadMaxLengthSetting())return;if(!1===await this.loadTagSetting())return;const t=await browser.storage.sync.get("data");null==t.data?this.classifier_.data={}:this.classifier_.data=t.data,l.a.removeOldStatistics(),l.a.removeOldReLearnLog(),this.garbageCollectionLearnModel(),this.deleteOldJudgeLog(),await this.loadStatistics(),this.settingLoaded_=!0}async loadStatistics(){this.totalStatistics_=await l.a.loadTotalStatistics()}async deleteOldJudgeLog(){let t=(await browser.storage.sync.get("log_delete_past_hour")).log_delete_past_hour;void 0===t&&(t=72);const e=await browser.storage.sync.get(null),s=new Date;for(const r in e)if(0===r.indexOf("__log_",0)){const a=e[r],i=new Date(a.logDate_);(s.getTime()-i.getTime())/36e5>t&&browser.storage.sync.remove(r)}}async garbageCollectionLearnModel(){const t=this.classifier_.data;for(const e in t)-1==this.tags_.findIndex(t=>!(e!=t.key||!t.useClassification))&&delete t[e];let e=0;for(const s in t)for(const r in t[s].word)e+=t[s].word[r];this.classifier_.data=t,this.classifier_.totalCount=e}async saveSetting(){await browser.storage.sync.set({data:this.classifier_.data,totalCount:this.classifier_.totalCount})}createMenu(){browser.menus.removeAll().then(()=>{for(const t of this.tags_)t.useClassification&&browser.menus.create({id:"doLearn"+t.key,title:browser.i18n.getMessage("learnMenu",t.name),contexts:["message_list"],onclick:async()=>{this.executeLearn(t)}});browser.menus.create({id:"all_classificate",title:browser.i18n.getMessage("allClassificateMenu"),contexts:["message_list"],onclick:async()=>{this.executeAllClassificate()}}),browser.menus.create({id:"classificate",title:browser.i18n.getMessage("classificateMenu"),contexts:["message_list"],onclick:async()=>{this.executeClassificate()}}),browser.menus.create({id:"view_log",title:browser.i18n.getMessage("viewLogMenu"),contexts:["message_list"],onclick:async()=>{this.executeViewLog()}})})}async*listMessages(t){let e=t;for(let t of e.messages)yield t;for(;e.id;){e=await browser.messages.continueList(e.id);for(let t of e.messages)yield t}}async executeAllClassificate(){if(!1===this.settingLoaded_)return void this.noticeNotSetting();const t=new Date;this.todayStatistics_=await l.a.loadStatsitics(t);const e=await browser.mailTabs.query({active:!0,currentWindow:!0});if(0===e.length)return;const s=e[0].displayedFolder,r=await browser.messages.list(s),a=this.listMessages(r);let i=a.next();const n=[];for(;!(await i).done;){const t=(await i).value;void 0!==t&&n.push(this.subAllClassificate(t)),i=a.next()}await Promise.all(n),this.saveStatistcs(t)}async subAllClassificate(t){!1===await this.isTagged(t)&&await this.classificationMessage(t)}async isTagged(t){return""!==await this.getClassificateTag(t)}async getClassificateTag(t){for(const e of t.tags)for(const t of this.tags_)if(t.useClassification&&t.key===e)return e;return""}async saveStatistcs(t){l.a.saveTotalStatistics(this.totalStatistics_),l.a.saveStatistics(this.todayStatistics_,t)}async executeLearn(t){const e=new Date;this.todayStatistics_=await l.a.loadStatsitics(e);const s=this.listMessages(await browser.mailTabs.getSelectedMessages());let r=s.next();const a=[];for(;!(await r).done;){const e=(await r).value;void 0!==e&&a.push(this.doLearn(e,t.key)),r=s.next()}await Promise.all(a),this.saveStatistcs(e)}async executeClassificate(){await this.classificateMain(await browser.mailTabs.getSelectedMessages())}async executeNewMailClassificate(t){await this.classificateMain(t)}async classificateMain(t){if(!1===this.settingLoaded_)return void this.noticeNotSetting();const e=new Date;this.todayStatistics_=await l.a.loadStatsitics(e);const s=this.listMessages(t);let r=s.next();const a=[];for(;!(await r).done;){const t=(await r).value;void 0!==t&&a.push(this.classificationMessage(t)),r=s.next()}await Promise.all(a),this.saveStatistcs(e)}async executeViewLog(){!1!==this.settingLoaded_?this.showLogViewer(await(await browser.mailTabs.getSelectedMessages()).messages[0]):this.noticeNotSetting()}async showLogViewer(t){await browser.storage.sync.set({logTarget:t});browser.tabs.create({url:"logviewer/logviewer.html"})}async getBodyMain(t){let e=this.getBody(t,h.PlainText);return 0===(await e).length&&(e=this.getBody(t,h.Html)),e}async getBody(t,e){let s="";if("parts"in t)for(var r of t.parts)s+=await this.getBody(r,e);if("body"in t&&t.contentType===e){let e=t.body;t.contentType===h.Html&&(e=e.replace(/<("[^"]*"|'[^']*'|[^'">])*>/g," "),e=e.replace(/&nbsp;/g,"")),e=e.replace(/([\u0000-\u002f])|([\u003a-\u0040])|([\u005b-\u0060])|([\u007b-\u00bf])|([\u02b9-\u0362])|([\u0374-\u0375])|([\u037A-\u037E])|([\u0384-\u0385])|\u0387/g," "),e=e.replace(/([\u2000-\u203e])|([\u20dd-\u20f0])|([\u2190-\u27ff])|([\u2900-\u2e70])|([\u2ff0-\u2ffb])/g," "),e=e.replace(/([\u3000-\u3040])|([\u3200-\u33ff])/g," "),e=e.replace(/([\ufe30-\ufe6b])|([\uff00-\uff0f])|([\uff1a-\uff20])|([\uff3b-\uff40])|([\uff5b-\uff65])/g," "),s+=e}return s}async doLearn(t,e){const s=await this.getTargetMessage(t);let r=0;do{r+=1;for(const t of s)this.classifier_.train({word:t},e)}while(await this.judgeClassification(t)!=e);const a=await this.getClassificateTag(t);if(""!=a?await this.classificationMessage(t,!0):await this.classificationMessage(t,!1),this.saveSetting(),""!=a){!1===await l.a.isReLearned(t)&&(this.totalStatistics_.wrongCount+=1,this.todayStatistics_.wrongCount+=1);const e={messageId:await g.a.getMailMessageId(t),date:new Date,previousClassification:a,changedClassification:await this.getClassificateTag(t)};l.a.saveReLearnLog(e)}}async scoring(t){const e={},s=await this.getTargetMessage(t),r=new o.a;for(const t of s){const a=this.classifier_.score({word:t});for(const s in a)null==e[s]&&(e[s]=0),e[s]+=a[s],null==r.scoreEachWord[t]?r.scoreEachWord[t]={count:0,score:{[s]:0}}:null==r.scoreEachWord[t].score[s]&&(r.scoreEachWord[t].score[s]=0),r.scoreEachWord[t].score[s]+=a[s];r.scoreEachWord[t].count+=1,r.targetText=s}let a=new Array(0);for(const t in e)a.push({category:t,score:e[t]});return{scoreTotal:a,logEntry:r}}async getTargetMessage(t){if(null==this.bodymaxlength_)throw new Error("bodymaxlength_ property not set. The settings may not be loaded yet.");const e=await browser.messages.getFull(t.id);let s=await this.getBodyMain(e);s=t.subject+s,s=s.slice(0,1024*this.bodymaxlength_);let r=(new i.a).segment(s);return r=r.filter(t=>!((t=t.trim()).length<=1)),r=r.concat(await this.getHeaderArray(t)),r}async getHeaderArray(t){let e=[];e.push("from:"+this.getMailAddress(t.author));const s=this.getDomain(t.author);void 0!==s&&e.push("from:"+s);for(const s of t.recipients){e.push("to:"+this.getMailAddress(s));const t=this.getDomain(s);void 0!==t&&e.push("to:"+t)}for(const s of t.ccList){e.push("cc:"+this.getMailAddress(s));const t=this.getDomain(s);void 0!==t&&e.push("cc:"+t)}return e}getMailAddress(t){if(0===t.length)return"";let e=t.lastIndexOf("<"),s=t.lastIndexOf(">");return-1===s&&(s=t.length),t.slice(e+1,s)}getDomain(t){const e=(t=this.getMailAddress(t)).split("@");return(e.length=2)?e[1]:void 0}async classificationMessage(t,e=!1){const s=t.id,r=await this.judgeClassification(t);""!=r&&await this.setClassificationTag(s,r,e)}async judgeClassification(t){const e=await this.scoring(t),s=this.ranking(e.scoreTotal),r=e.logEntry;return r.id=await g.a.getMailMessageId(t),r.classifiedTag=s,r.score=e.scoreTotal,await r.save(),s}ranking(t){if(0==t.length)return"";return t.sort((t,e)=>e.score-t.score)[0].category}async setClassificationTag(t,e,s=!1){const r=await browser.messages.get(t),a=r.tags.filter(t=>{for(const e of this.tags_)if(e.useClassification&&e.key==t)return!1;return!0});a.push(e);const i={flagged:r.flagged,junk:r.junk,read:r.read,tags:a};!1===s&&(this.totalStatistics_.totalCount+=1,this.todayStatistics_.totalCount+=1),await browser.messages.update(t,i)}noticeNotSetting(){browser.notifications.create(c.NOTIFY_ID_NOT_SET,{type:"basic",title:"AutoBucket",iconUrl:browser.extension.getURL("icons/icon_48.png"),message:browser.i18n.getMessage("infoNotSetting")})}noticeClearNotSetting(){browser.notifications.clear(c.NOTIFY_ID_NOT_SET)}}c.NOTIFY_ID_NOT_SET="notset";const h={PlainText:"text/plain",Html:"text/html"};new c},20:function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));class r{constructor(){this.id_="",this.logDate_=new Date,this.scoreEachWord_={},this.targetText_=[],this.classifiedTag_="",this.totalScore_=[]}get id(){return this.id_}set id(t){this.id_=t}get logDate(){return this.logDate_}set logDate(t){this.logDate_=t}get score(){return this.totalScore_}set score(t){this.totalScore_=t}get scoreEachWord(){return this.scoreEachWord_}set scoreEachWord(t){this.scoreEachWord_=t}get targetText(){return this.targetText_}set targetText(t){this.targetText_=t}get classifiedTag(){return this.classifiedTag_}set classifiedTag(t){this.classifiedTag_=t}async save(){if(""==this.id_||null==this.id_)throw new Error("Not set id");if(0==Object.keys(this.scoreEachWord_).length)throw new Error("Not set scoreEachWord");if(0==this.targetText_.length)throw new Error("Not set targetText");if(""==this.classifiedTag_||null==this.classifiedTag_)throw new Error("Not set classifiedTag");const t="__log_"+this.id;await browser.storage.sync.set({[t]:this})}async load(){if(""==this.id_||null==this.id_)throw new Error("Not set id");const t="__log_"+this.id,e=(await browser.storage.sync.get(t))[t];return void 0!==e&&(null!=e&&(this.classifiedTag_=e.classifiedTag_,this.logDate_=e.logDate_,this.scoreEachWord_=e.scoreEachWord_,this.totalScore_=e.totalScore_,this.targetText_=e.targetText_,!0))}}},4:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var r=s(8);class a{static async loadTotalStatistics(){const t=await browser.storage.sync.get(this.TOTAL_STATISTICS_KEY);return null==t.statistics?this.getInitialObj():this.toStatisticsLog(t.statistics)}static async saveTotalStatistics(t){void 0===t.date&&(t.date=new Date);const e=this.toStatistcsObj(t);await browser.storage.sync.set({[this.TOTAL_STATISTICS_KEY]:e})}static async removeTotalStatistics(){await browser.storage.sync.remove(this.TOTAL_STATISTICS_KEY)}static async loadStatsitics(t){const e=this.STATISTICS_LOG_PREFIX+t.toDateString();let s=(await browser.storage.sync.get(e))[e];if(void 0===s)return this.getInitialObj();return this.toStatisticsLog(s)}static toStatisticsLog(t){return{date:new Date(t.date),totalCount:t.totalCount,wrongCount:t.wrongCount}}static toStatistcsObj(t){if(void 0===t.date)throw new Error("not set date property of StatisticsLog");return{date:t.date.toISOString(),totalCount:t.totalCount,wrongCount:t.wrongCount}}static async saveStatistics(t,e){const s=this.toStatistcsObj(t),r=this.STATISTICS_LOG_PREFIX+e.toDateString();await browser.storage.sync.set({[r]:s})}static async removeOldStatistics(){const t=new Date,e=this.DELETE_STATISTICS_PAST_DAY;this.listStatistics(async(s,r)=>{if(void 0!==r.date){(t.getTime()-r.date.getTime())/864e5>e&&await browser.storage.sync.remove(s)}})}static async removeAllStatistics(){this.listStatistics(async t=>{await browser.storage.sync.remove(t)})}static async getListStatistics(){const t=[];return await this.listStatistics(async(e,s)=>{t.push(s)}),t.sort((t,e)=>{const s=void 0===t.date?new Date(0):t.date,r=void 0===e.date?new Date(0):e.date;return s.getTime()-r.getTime()})}static async resetStatistics(){const t=[];t.push(this.removeTotalStatistics()),t.push(this.removeAllStatistics()),t.push(this.removeAllReLearnLog()),await Promise.all(t)}static async listStatistics(t){const e=await browser.storage.sync.get(null);for(const s in e)if(0===s.indexOf(this.STATISTICS_LOG_PREFIX,0)){t(s,this.toStatisticsLog(e[s]))}return[]}static getInitialObj(){return{date:new Date,totalCount:0,wrongCount:0}}static async isReLearned(t){return void 0!==await this.loadReLearnLog(t)}static async loadReLearnLog(t){const e=await r.a.getMailMessageId(t),s=this.RE_LEARN_LOG_PREFIX+e,a=await browser.storage.sync.get(s),i=this.toReLearnLog(a[s]);if(void 0!==i)return i}static async saveReLearnLog(t){const e=t.messageId,s=this.RE_LEARN_LOG_PREFIX+e;await browser.storage.sync.set({[s]:this.toReLearnObj(t)})}static async removeOldReLearnLog(){const t=new Date,e=this.DELETE_RE_LEARN_LOG_PAST_DAY;this.listReLearnLog(async(s,r)=>{if(void 0!==r.date){(t.getTime()-r.date.getTime())/864e5>e&&browser.storage.sync.remove(s)}})}static async removeAllReLearnLog(){this.listReLearnLog(async t=>{browser.storage.sync.remove(t)})}static async listReLearnLog(t){const e=await browser.storage.sync.get(null);for(const s in e)if(0===s.indexOf(this.RE_LEARN_LOG_PREFIX,0)){const r=this.toReLearnLog(e[s]);void 0!==r&&t(s,r)}return[]}static toReLearnLog(t){if(void 0===t)return;return{messageId:t.messageId,date:new Date(t.date),previousClassification:t.previousClassification,changedClassification:t.changedClassification}}static toReLearnObj(t){return{messageId:t.messageId,date:t.date.toISOString(),previousClassification:t.previousClassification,changedClassification:t.changedClassification}}}a.STATISTICS_LOG_PREFIX="__stat_",a.RE_LEARN_LOG_PREFIX="__relog_",a.TOTAL_STATISTICS_KEY="statistics",a.DELETE_STATISTICS_PAST_DAY=30,a.DELETE_RE_LEARN_LOG_PAST_DAY=30},8:function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));class r{static async getMailMessageId(t){const e=(await browser.messages.getFull(t.id)).headers["message-id"];if(null==e)throw new Error("do not get mail message-id");return e}}}});